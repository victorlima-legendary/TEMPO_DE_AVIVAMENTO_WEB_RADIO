<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Sua Empresa ou Nome" />
    <meta name="description" content="Descrição da sua página ou rádio" />
    <meta name="keywords" content="rádio, web rádio, música, ao vivo" />
    <title>WEB RÁDIO - TEMPO DE AVIVAMENTO</title>
    <link
      rel="shortcut icon"
      href="./src/assets/favicon.png"
      type="image/x-icon"
    />

    <!-- Pré-carregar CSS -->
    <link rel="preload" href="./src/style/player.css" as="style" />
    <link rel="preload" href="./src/style/main.css" as="style" />
    <link rel="preload" href="./src/style/ads_content.css" as="style" />
    <link rel="preload" href="./src/style/style.css" as="style" />
    <link rel="preload" href="./src/style/reset.css" as="style" />
    <link rel="preload" href="./src/style/keyframes.css" as="style" />
    <link rel="preload" href="./src/style/eventos_section.css" as="style" />
    <link rel="preload" href="./src/style/slider.css" as="style" />
    <link rel="preload" href="./src/style/vars.css" as="style" />
    <link rel="preload" href="./src/style/dropdown_mobile.css" as="style" />
    <link rel="preload" href="./src/style/header.css" as="style" />
    <link rel="preload" href="./src/style/media-queries.css" as="style" />

    <!-- Links para CSS -->
    <link rel="stylesheet" href="./src/style/player.css" />
    <link rel="stylesheet" href="./src/style/main.css" />
    <link rel="stylesheet" href="./src/style/keyframes.css" />
    <link rel="stylesheet" href="./src/style/style.css" />
    <link rel="stylesheet" href="./src/style/ads_content.css" />
    <link rel="stylesheet" href="./src/style/eventos_section.css" />
    <link rel="stylesheet" href="./src/style/reset.css" />
    <link rel="stylesheet" href="./src/style/slider.css" />
    <link rel="stylesheet" href="./src/style/sections.css" />
    <link rel="stylesheet" href="./src/style/vars.css" />
    <link rel="stylesheet" href="./src/style/dropdown_mobile.css" />
    <link rel="stylesheet" href="./src/style/header.css" />
    <link rel="stylesheet" href="./src/style/media-queries.css" />

    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap"
      rel="stylesheet"
    />

    <!-- LINK CSS ICONS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
  </head>
  <body>
    <div class="page-background">
      <!--  -->
      <div id="header"></div>
      <!--  -->
      <div class="page-content">
        <div class="page-slider">
          <picture>
            <source
              media="(max-width: 550px)"
              srcset="./src/assets/slide_mobile.jpeg"
            />

            <img
              width="100%"
              height="auto"
              src="./src/assets/slide.webp"
              alt="Banner Rádio"
            />
          </picture>
          <!--  -->
        </div>
        <!-- MAIN CONTENT -->
        <main>
          <!--  -->
          <div class="main__palavra-do-dia">
            <picture class="palavra">
              <div class="img-txt">
                <img
                  width="100%"
                  height="auto"
                  src="./src/assets/palavra.png"
                  alt="word_image"
                />
                <span style="color: black"
                  >Palavra do Dia - <q id="frase"></q
                ></span>
              </div>
            </picture>
            <!--  -->
            <div class="pedido">
              <a
                href="https://wa.me/5511976916597?text=Ola!! Gostaria de pedir uma palavra!!"
                ><button type="button">PEDIR UMA PALAVRA</button></a
              >
            </div>
          </div>
          <!--  -->
          <div class="sections">
            <div id="sections" class="sections__player">
              <div class="player">
                <div class="video">
                  <span class="fa-solid fa-tv"><b>PLAYER:</b></span>

                  <iframe
                    style="width: 100%"
                    src="https://player.rbstream.com.br/video/radioc16/1/true/false/WkVoWmRXTnRTbnBrU0Vwc1dWY3dkVmt5T1hSTWJVcDUrMw==/16:9/"
                    scrolling="yes"
                    frameborder="0"
                    allowfullscreen
                  ></iframe>
                </div>
              </div>
              <div class="eventos">
                <div class="eventos-content">
                  <span class="fa-solid fa-calendar-week"><b>EVENTOS</b></span>
                  <!--  -->
                  <div class="container_relativo">
                    <div id="postsContainer" class="eventos_post"></div>
                  </div>
                </div>
              </div>
            </div>
            <!--  -->
            <div id="sections" class="ads">
              <div class="ads-content">
                <span><b>--- anúncios ---</b></span>
                <div class="ads-content__content">
                  <!--  -->
                  <div class="arrows">
                    <span id="arrow-left" class="fa-solid fa-arrow-left"></span>
                    <span
                      id="arrow-right"
                      class="fa-solid fa-arrow-right"
                    ></span>
                  </div>
                  <!--  -->
                  <div class="img-ads">
                    <!-- AS IMAGENS SERÃO CARREGADAS AQUI -->
                  </div>
                </div>
                <!--  -->
              </div>
            </div>
            <!--  -->
            <div id="sections"></div>
            <!--  -->
            <div id="sections"></div>
            <!--  -->
            <div id="sections"></div>
          </div>
        </main>
        <!--  -->
      </div>
    </div>
    <!-- ------------ -->
    <!-- PLAYER FIXO -->
    <div class="main__audio-player">
      <a target="_blank" href="https://wa.me/5511989441340?text=Ola!!">
        <button>PEDIDO</button>
      </a>
      <div class="audio-player__content">
        <audio
          autoplay
          id="audio-stream"
          src="https://stm4.audio.rbstream.com.br:7162/stream"
        ></audio>
        <!--  -->
        <img id="album-cover" src="" alt="Capa do Álbum" />
        <div id="now-playing"></div>
        <div id="play-pause">&#9658;</div>
      </div>
    </div>
    <!-- ======================================== -->
    <script type="module">
      import { getGithubToken } from "./src/js/limao.js";

      const repoOwner = "victorlima-legendary";
      const repoName = "JSON_RADIO";
      const jsonFile = "ads.json";

      const container = document.querySelector(".img-ads");
      const arrowLeft = document.getElementById("arrow-left");
      const arrowRight = document.getElementById("arrow-right");

      let currentIndex = 0;
      let totalItems = 0;
      let scrollInterval;

      async function carregarAnuncios() {
        const githubToken = await getGithubToken();

        if (!githubToken) {
          console.error("Token inválido ou não carregado.");
          return;
        }

        try {
          const res = await fetch(
            `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${jsonFile}`,
            {
              headers: {
                Authorization: `Bearer ${githubToken}`,
              },
            }
          );

          const data = await res.json();
          const content = atob(data.content);
          const json = JSON.parse(content);

          const imagens = json.imagens || [];
          totalItems = imagens.length;

          imagens.forEach((img) => {
            const imgWrapper = document.createElement("div");
            imgWrapper.classList.add("img-ads__item");

            const el = document.createElement("img");
            el.src = img.link;
            el.alt = img.nome;

            imgWrapper.appendChild(el);
            container.appendChild(imgWrapper);
          });
        } catch (error) {
          console.error("Erro ao carregar imagens:", error);
        }
      }

      function scrollToIndex(index) {
        const width = container.clientWidth;
        container.scrollTo({ left: index * width, behavior: "smooth" });
      }

      function rolarAutomaticamente() {
        scrollInterval = setInterval(() => {
          currentIndex = (currentIndex + 1) % totalItems;
          scrollToIndex(currentIndex);
        }, 5000);
      }

      arrowLeft.addEventListener("click", () => {
        clearInterval(scrollInterval);
        currentIndex = (currentIndex - 1 + totalItems) % totalItems;
        scrollToIndex(currentIndex);
        rolarAutomaticamente();
      });

      arrowRight.addEventListener("click", () => {
        clearInterval(scrollInterval);
        currentIndex = (currentIndex + 1) % totalItems;
        scrollToIndex(currentIndex);
        rolarAutomaticamente();
      });

      carregarAnuncios().then(rolarAutomaticamente);
    </script>

    <script type="module" src="./src/js/post_main.js"></script>
    <script type="module" src="./src/js/limao.js"></script>
    <script type="module" src="./src/js/palavra.js"></script>
    <script src="./src/js/player.js"></script>
    <script>
      /* CARREGAR CABEÇALHO */
      fetch("header.html")
        .then((response) => response.text())
        .then((data) => {
          document.getElementById("header").innerHTML = data;
        });
    </script>
  </body>
</html>
